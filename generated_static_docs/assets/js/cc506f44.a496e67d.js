"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[406],{4176:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"api/git-helpers","title":"Git Helpers","description":"Functions that query commit history and diffs to produce analytics.","source":"@site/docs/api/git-helpers.md","sourceDirName":"api","slug":"/api/git-helpers","permalink":"/docs/api/git-helpers","draft":false,"unlisted":false,"editUrl":"https://github.com/your-org/analrepo/tree/main/docs/docs/api/git-helpers.md","tags":[],"version":"current","frontMatter":{"title":"Git Helpers","description":"Functions that query commit history and diffs to produce analytics."},"sidebar":"docsSidebar","previous":{"title":"API Overview","permalink":"/docs/api/overview"},"next":{"title":"Config Parsing","permalink":"/docs/api/config-parsing"}}');var r=n(4848),i=n(8453);const a={title:"Git Helpers",description:"Functions that query commit history and diffs to produce analytics."},o=void 0,c={},l=[];function d(t){const e={code:"code",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...t.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.p,{children:"The helpers wrap Git commands for consistent, parseable output."}),"\n",(0,r.jsx)(e.p,{children:"git_log"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'def git_log(args):\n    result = subprocess.run(["git"] + args, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)\n    return result.stdout.strip()\n'})}),"\n",(0,r.jsx)(e.p,{children:"get_commit_stats"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'def get_commit_stats(since=None):\n    args = ["log", "--shortstat", "--pretty=format:%H%x09%an%x09%ad", "--date=iso"]\n    if since:\n        args.append(f"--since={since}")\n    log = git_log(args)\n    commits = []\n    for entry in log.split("\\n"):\n        parts = entry.split("\\t")\n        if len(parts) == 3:\n            commits.append({"hash": parts[0], "author": parts[1], "date": parts[2]})\n    return commits\n'})}),"\n",(0,r.jsx)(e.p,{children:"get_diff_stats"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'def get_diff_stats(commit_range=None, ignored_exts=None):\n    args = ["diff", "--numstat"]\n    if commit_range:\n        args.append(commit_range)\n    diff = git_log(args)\n    total_add, total_del = 0, 0\n    language_counts = defaultdict(int)\n    ignored_exts = set(ignored_exts or [])\n    for line in diff.splitlines():\n        parts = line.split("\\t")\n        if len(parts) == 3:\n            try:\n                add = int(parts[0]); delete = int(parts[1])\n            except ValueError:\n                continue\n            ext = Path(parts[2]).suffix.lower().replace(".", "")\n            if ext in ignored_exts:\n                continue\n            language_counts[ext] += add + delete\n            total_add += add; total_del += delete\n    return total_add, total_del, language_counts\n'})}),"\n",(0,r.jsx)(e.p,{children:"Notes:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"get_diff_stats uses \u201cnumstat\u201d for machine-friendly counts"}),"\n",(0,r.jsx)(e.li,{children:"Binary changes may appear as \u201c-\u201d and are skipped"}),"\n"]})]})}function p(t={}){const{wrapper:e}={...(0,i.R)(),...t.components};return e?(0,r.jsx)(e,{...t,children:(0,r.jsx)(d,{...t})}):d(t)}},8453:(t,e,n)=>{n.d(e,{R:()=>a,x:()=>o});var s=n(6540);const r={},i=s.createContext(r);function a(t){const e=s.useContext(i);return s.useMemo(function(){return"function"==typeof t?t(e):{...e,...t}},[e,t])}function o(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(r):t.components||r:a(t.components),s.createElement(i.Provider,{value:e},t.children)}}}]);