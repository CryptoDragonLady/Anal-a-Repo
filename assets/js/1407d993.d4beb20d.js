"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[902],{1451:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>l,contentTitle:()=>r,default:()=>g,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"scripts/generate-stats3","title":"generate_stats3.py","description":"Config-based analytics that reads configuration from a `` block in your README.","source":"@site/docs/scripts/generate-stats3.md","sourceDirName":"scripts","slug":"/scripts/generate-stats3","permalink":"/Anal-a-Repo/docs/scripts/generate-stats3","draft":false,"unlisted":false,"editUrl":"https://github.com/CryptoDragonLady/Anal-a-Repo/tree/main/docs/docs/scripts/generate-stats3.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"generate_stats3.py"},"sidebar":"docsSidebar","previous":{"title":"generate_stats2.py","permalink":"/Anal-a-Repo/docs/scripts/generate-stats2"},"next":{"title":"generate_stats4.py","permalink":"/Anal-a-Repo/docs/scripts/generate-stats4"}}');var o=s(4848),a=s(8453);const i={sidebar_position:3,title:"generate_stats3.py"},r="generate_stats3.py",l={},d=[{value:"Overview",id:"overview",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Usage",id:"usage",level:2},{value:"Configuration Format",id:"configuration-format",level:2}];function c(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"generate_stats3py",children:"generate_stats3.py"})}),"\n",(0,o.jsxs)(e.p,{children:["Config-based analytics that reads configuration from a ",(0,o.jsx)(e.code,{children:"<details>"})," block in your README."]}),"\n",(0,o.jsx)(e.h2,{id:"overview",children:"Overview"}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.code,{children:"generate_stats3.py"})," introduces global configuration management by reading JSON settings from your README file. This allows you to configure timeframes, language ignore lists, and graph settings in one central location."]}),"\n",(0,o.jsx)(e.h2,{id:"key-features",children:"Key Features"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Global Configuration"}),": Single JSON config block controls all analytics"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Customizable Timeframes"}),": Use ",(0,o.jsx)(e.code,{children:"d"})," (days) or ",(0,o.jsx)(e.code,{children:"h"})," (hours) format"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Language Ignore Lists"}),": Exclude specific file extensions"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Graph Customization"}),": Configure colors, sizes, and display options"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"No External Dependencies"}),": Uses only Python standard library"]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"usage",children:"Usage"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"python generate_stats3.py\n"})}),"\n",(0,o.jsx)(e.h2,{id:"configuration-format",children:"Configuration Format"}),"\n",(0,o.jsxs)(e.p,{children:["Add this configuration block to your ",(0,o.jsx)(e.code,{children:"README.md"}),":"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-markdown",children:'<details>\n<summary>\ud83d\udcc8 Analytics Config</summary>\n\n```json\n{\n  "timeframes": {\n    "All Time": null,\n    "Last 90 Days": "90d",\n    "Last 30 Days": "30d",\n    "Last Week": "7d",\n    "Last 24 Hours": "24h"\n  },\n  "graphs": {\n    "show": true,\n    "width": 400,\n    "height": 120,\n    "color": "#4e79a7"\n  },\n  "languages": {\n    "show_breakdown": true,\n    "ignore": ["lock", "json", "min"]\n  },\n  "contributors": {\n    "show": true,\n    "max": 10\n  }\n}\n```\n\n</details>\n````markdown\n\n## Configuration Options\n\n### Timeframes\n\nDefine custom time periods:\n\n```json\n"timeframes": {\n  "Label": "value"\n}\n```\n\n**Values**:\n- `null` or `"all"`: All commits\n- `"30d"`: Last 30 days\n- `"24h"`: Last 24 hours\n- `"90d"`, `"7d"`, etc.\n\n### Graphs\n\nControl graph display:\n\n```json\n"graphs": {\n  "show": true,\n  "width": 400,\n  "height": 120,\n  "color": "#4e79a7"\n}\n```\n\n**Options**:\n- `show` (boolean): Display graphs or not\n- `width` (int): Graph width in pixels (placeholder)\n- `height` (int): Graph height in pixels (placeholder)\n- `color` (string): Hex color code\n\n### Languages\n\nControl language analytics:\n\n```json\n"languages": {\n  "show_breakdown": true,\n  "ignore": ["lock", "json", "min", "map"]\n}\n```\n\n**Options**:\n- `show_breakdown` (boolean): Show language breakdown\n- `ignore` (array): File extensions to exclude (without dots)\n\n### Contributors\n\nConfigure contributor display:\n\n```json\n"contributors": {\n  "show": true,\n  "max": 10\n}\n```\n\n**Options**:\n- `show` (boolean): Display contributors\n- `max` (int): Maximum contributors to show (placeholder)\n\n## Output Format\n\nSimilar to `generate_stats.py` but respecting configuration:\n\n```markdown\n### \ud83d\udcca Repository Stats\n\n| Period | Commits | Additions/Deletions | Total Lines | Languages |\n|--------|----------|---------------------|--------------|-----------|\n| All Time | 45 | +12,345 / -6,789 | 19,134 | PY(8500), JS(4200) |\n| Last 90 Days | 35 | +9,800 / -4,300 | 14,100 | PY(7200), JS(3500) |\n| Last 30 Days | 12 | +2,300 / -890 | 3,190 | PY(1800), JS(900) |\n```\n\n**Note**: Ignores languages specified in config (e.g., lock, json files)\n\n## How It Works\n\n### 1. Config Parsing\n\n```python\ndef parse_global_config(readme_text: str) -> dict:\n    match = re.search(\n        r"<details>\\s*<summary>.*?Analytics Config.*?</summary>\\s*```json(.*?)```.*?</details>",\n        readme_text,\n        re.DOTALL | re.IGNORECASE,\n    )\n    return json.loads(match.group(1).strip())\n```\n\n### 2. Timeframe Resolution\n\n```python\ndef resolve_timeframes(cfg):\n    now = datetime.utcnow()\n    mapping = {}\n    for label, value in cfg["timeframes"].items():\n        if value.endswith("d"):\n            days = int(value[:-1])\n            mapping[label] = (now - timedelta(days=days)).isoformat()\n        elif value.endswith("h"):\n            hours = int(value[:-1])\n            mapping[label] = (now - timedelta(hours=hours)).isoformat()\n    return mapping\n```\n\n### 3. Language Filtering\n\n```python\ndef get_diff_stats(commit_range=None, ignored_exts=None):\n    ignored_exts = set(ignored_exts or [])\n    for line in diff.splitlines():\n        ext = Path(filename).suffix.lower().replace(".", "")\n        if ext in ignored_exts:\n            continue\n        language_counts[ext] += add + delete\n```\n\n## Example Setup\n\n````markdown\n# My Project\n\n<details>\n<summary>\ud83d\udcc8 Analytics Config</summary>\n\n```json\n{\n  "timeframes": {\n    "All Time": null,\n    "Last Quarter": "90d",\n    "Last Month": "30d"\n  },\n  "languages": {\n    "show_breakdown": true,\n    "ignore": ["lock", "json", "svg"]\n  },\n  "graphs": {\n    "show": true,\n    "color": "#FF6B6B"\n  }\n}\n```\n\n</details>\n\n\x3c!-- STATS BREAKDOWN START:OVERVIEW --\x3e\n\x3c!-- STATS BREAKDOWN END:OVERVIEW --\x3e\n````markdown\n\n## Advanced Usage\n\n### Custom Timeframe Labels\n\n```json\n"timeframes": {\n  "Project Lifetime": null,\n  "Current Sprint": "14d",\n  "This Week": "7d",\n  "Today": "24h"\n}\n```\n\n### Ignoring Build Artifacts\n\n```json\n"languages": {\n  "ignore": ["lock", "min", "map", "bundle", "chunk"]\n}\n```\n\n### Multiple Ignore Patterns\n\n```json\n"languages": {\n  "ignore": [\n    "lock", "json", "yaml",\n    "min", "map",\n    "svg", "png", "jpg"\n  ]\n}\n```\n\n## Fallback Behavior\n\nIf no config is found:\n\n```python\nDEFAULT_CONFIG = {\n    "timeframes": {\n        "All Time": None,\n        "Last 30 Days": "30d",\n        "Last 7 Days": "7d",\n        "Last 24 Hours": "24h",\n    },\n    "graphs": {"show": True, "width": 400, "height": 100, "color": "#4e79a7"},\n    "languages": {"show_breakdown": True, "ignore": []},\n    "contributors": {"show": True, "max": 10},\n}\n```\n\n## Comparison with Other Scripts\n\n| Feature | stats.py | stats3.py |\n|---------|----------|-----------|\n| Configuration | Per-block JSON | Global JSON |\n| Timeframe Format | ISO datetime | d/h format |\n| Ignore Lists | No | Yes |\n| Dependencies | None | None |\n| Ease of Config | Medium | Easy |\n\n## Troubleshooting\n\n### Config Not Found\n\n**Symptom**: Warning "No analytics config found in README."\n\n**Solution**: Add config block with proper formatting:\n```markdown\n<details>\n<summary>\ud83d\udcc8 Analytics Config</summary>\n\n```json\n{...}\n```\n\n</details>\n```\n\n### Invalid JSON\n\n**Symptom**: Warning "Invalid JSON in analytics config"\n\n**Solution**: Validate JSON at [jsonlint.com](https://jsonlint.com)\n\n### Languages Still Showing\n\n**Check**: Extension format in ignore list (no dots):\n```json\n"ignore": ["lock"]  // Correct\n"ignore": [".lock"] // Wrong\n```\n\n## See Also\n\n- [generate_stats4.py](/docs/scripts/generate-stats4): Enhanced version with real language data\n- [Configuration Guide](/docs/configuration)\n- [API Reference - Config Parsing](/docs/api/config-parsing)\n'})})]})}function g(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(c,{...n})}):c(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>i,x:()=>r});var t=s(6540);const o={},a=t.createContext(o);function i(n){const e=t.useContext(a);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:i(n.components),t.createElement(a.Provider,{value:e},n.children)}}}]);